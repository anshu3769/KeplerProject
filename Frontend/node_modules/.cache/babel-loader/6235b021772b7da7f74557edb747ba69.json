{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar React = tslib_1.__importStar(require(\"react\"));\n\nvar hoist_non_react_statics_1 = tslib_1.__importDefault(require(\"hoist-non-react-statics\"));\n\nvar parser_1 = require(\"./parser\");\n\nvar Query_1 = tslib_1.__importDefault(require(\"./Query\"));\n\nvar hoc_utils_1 = require(\"./hoc-utils\");\n\nfunction withQuery(document, operationOptions) {\n  if (operationOptions === void 0) {\n    operationOptions = {};\n  }\n\n  var operation = parser_1.parser(document);\n  var _a = operationOptions.options,\n      options = _a === void 0 ? hoc_utils_1.defaultMapPropsToOptions : _a,\n      _b = operationOptions.skip,\n      skip = _b === void 0 ? hoc_utils_1.defaultMapPropsToSkip : _b,\n      _c = operationOptions.alias,\n      alias = _c === void 0 ? 'Apollo' : _c;\n  var mapPropsToOptions = options;\n\n  if (typeof mapPropsToOptions !== 'function') {\n    mapPropsToOptions = function mapPropsToOptions() {\n      return options;\n    };\n  }\n\n  var mapPropsToSkip = skip;\n\n  if (typeof mapPropsToSkip !== 'function') {\n    mapPropsToSkip = function mapPropsToSkip() {\n      return skip;\n    };\n  }\n\n  var lastResultProps;\n  return function (WrappedComponent) {\n    var graphQLDisplayName = alias + \"(\" + hoc_utils_1.getDisplayName(WrappedComponent) + \")\";\n\n    var GraphQL = function (_super) {\n      tslib_1.__extends(GraphQL, _super);\n\n      function GraphQL() {\n        return _super !== null && _super.apply(this, arguments) || this;\n      }\n\n      GraphQL.prototype.render = function () {\n        var _this = this;\n\n        var props = this.props;\n        var shouldSkip = mapPropsToSkip(props);\n        var opts = shouldSkip ? Object.create(null) : tslib_1.__assign({}, mapPropsToOptions(props));\n\n        if (!shouldSkip && !opts.variables && operation.variables.length > 0) {\n          opts.variables = hoc_utils_1.calculateVariablesFromProps(operation, props);\n        }\n\n        return React.createElement(Query_1.default, tslib_1.__assign({}, opts, {\n          displayName: graphQLDisplayName,\n          skip: shouldSkip,\n          query: document,\n          warnUnhandledError: true\n        }), function (_a) {\n          var _ = _a.client,\n              data = _a.data,\n              r = tslib_1.__rest(_a, [\"client\", \"data\"]);\n\n          var _b, _c;\n\n          if (operationOptions.withRef) {\n            _this.withRef = true;\n            props = Object.assign({}, props, {\n              ref: _this.setWrappedInstance\n            });\n          }\n\n          if (shouldSkip) return React.createElement(WrappedComponent, tslib_1.__assign({}, props));\n          var result = Object.assign(r, data || {});\n          var name = operationOptions.name || 'data';\n          var childProps = (_b = {}, _b[name] = result, _b);\n\n          if (operationOptions.props) {\n            var newResult = (_c = {}, _c[name] = result, _c.ownProps = props, _c);\n            lastResultProps = operationOptions.props(newResult, lastResultProps);\n            childProps = lastResultProps;\n          }\n\n          return React.createElement(WrappedComponent, tslib_1.__assign({}, props, childProps));\n        });\n      };\n\n      GraphQL.displayName = graphQLDisplayName;\n      GraphQL.WrappedComponent = WrappedComponent;\n      return GraphQL;\n    }(hoc_utils_1.GraphQLBase);\n\n    return hoist_non_react_statics_1.default(GraphQL, WrappedComponent, {});\n  };\n}\n\nexports.withQuery = withQuery;","map":null,"metadata":{},"sourceType":"script"}